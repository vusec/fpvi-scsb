# Rage Against the Machine Clear: A Systematic Analysis of Machine Clears and Their Implications for Transient Execution Attacks

This repository contains test code, examples and exploits regarding transient windows generated by Machine Clears.

For more information about our work:

* Project page: [https://www.vusec.net/projects/fpvi-scsb](https://www.vusec.net/projects/fpvi-scsb)
* Paper PDF: [http://download.vusec.net/papers/fpvi-scsb_sec21.pdf](http://download.vusec.net/papers/fpvi-scsb_sec21.pdf)
* Intel security advisory on FPVI (CVE-2021-0086) and SCSB (CVE-2021-0089): [https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00516.html](https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00516.html)

## Setup and Environment

To compile all the code and configure your environment, simply perform the following:

```
make
source config.sh
```

## Repository organization

Every folder contains a separated README with more details. In summary, this is the content of every folder:

* [fp_reverse_engineering](fp_reverse_engineering): utilities to test, understand and verify the
presence of FPVI vulnerability
* [leakers](leakers): example test code to show how every presented machine clear can
be used to read transiently memory
* [leak_rate_win_size](leak_rate_win_size): code to measure leak rate and window size
of various transient execution mechanisms
* [md_reverse_engineering](md_reverse_engineering): experiments to reverse engineer
the memory disambiguation predictor on Intel processor
* [fpvi_firefox_exploit](fpvi_firefox_exploit): Firefox exploit based on FPVI to
leak arbitrary memory locations (CVE-2021-29955).

## FPVI Firefox Exploit demo

[![youtube demo video](https://img.youtube.com/vi/fGdCUuGeELA/0.jpg)](https://youtu.be/fGdCUuGeELA)

